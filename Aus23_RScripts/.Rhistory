filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_minimal()
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test()
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=TaxClass, y=lfc_TreeSpeciesPine, group=otu)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test()
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
geom_text(aes(label = TaxClass), hjust = -0.3)
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df$TaxClass)
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>% View
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df$TaxClass)
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
theme_test() +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df$TaxClass)
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)])) %>%
ggplot(aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
scale_x_discrete(labels = .$TaxClass)
ANCOM_ITS_pooled_root_df_plot=
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ggplot(ANCOM_ITS_pooled_root_df_plotaes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass)
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass)
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass)
ANCOM_ITS_pooled_soil = ancombc2(data = Phyloseq_pooled_ITS_soil,
fix_formula = "TreeSpecies",
p_adj_method = "fdr", pseudo_sens = TRUE,
prv_cut = 0.10, lib_cut = 1000, s0_perc = 0.05,
group = "TreeSpecies", struc_zero = FALSE, neg_lb = FALSE,
alpha = 0.05, n_cl = 2, verbose = TRUE,
global = TRUE, pairwise = FALSE,
dunnet = FALSE, trend = FALSE,
iter_control = list(tol = 1e-5, max_iter = 20,
verbose = FALSE),
em_control = list(tol = 1e-5, max_iter = 100),
lme_control = lme4::lmerControl(),
mdfdr_control = list(fwer_ctrl_method = "fdr", B = 100),
trend_control = NULL)
Phyloseq_pooled_ITS_soil=subset_samples(Phyloseq_pooled_ITS, SampleType=="Soil")
ANCOM_ITS_pooled_soil = ancombc2(data = Phyloseq_pooled_ITS_soil,
fix_formula = "TreeSpecies",
p_adj_method = "fdr", pseudo_sens = TRUE,
prv_cut = 0.10, lib_cut = 1000, s0_perc = 0.05,
group = "TreeSpecies", struc_zero = FALSE, neg_lb = FALSE,
alpha = 0.05, n_cl = 2, verbose = TRUE,
global = TRUE, pairwise = FALSE,
dunnet = FALSE, trend = FALSE,
iter_control = list(tol = 1e-5, max_iter = 20,
verbose = FALSE),
em_control = list(tol = 1e-5, max_iter = 100),
lme_control = lme4::lmerControl(),
mdfdr_control = list(fwer_ctrl_method = "fdr", B = 100),
trend_control = NULL)
ANCOM_ITS_pooled_soil_df=
ANCOM_ITS_pooled_soil$res %>%
as.data.frame %>%
rename("otu"="taxon") %>%
left_join(TaxMatITS) %>%
mutate(TaxClass=ifelse(!is.na(Species),Species,ifelse(!is.na(Genus),Genus,ifelse(!is.na(Family),Family,ifelse(!is.na(Order),Order,ifelse(!is.na(Class),Class,ifelse(!is.na(Phylum),Phylum,Kingdom)))))))
ANCOM_ITS_pooled_soil_df_plot=
ANCOM_ITS_pooled_soil_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass)
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_soil_df_plot$TaxClass)
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_soil_df_plot$TaxClass)
nrow(OtuMat16S_rare_pooled)
#####16S
OTU_16S_pooled_phyloseq=
OtuMat16S_rare_pooled %>%
as.matrix %>%
otu_table(taxa_are_rows = FALSE)
TAX_16S_pooled_phyloseq=
TaxMat16S_SILVA %>%
filter(otu %in% colnames(OtuMat16S_rare_pooled)) %>%
column_to_rownames("otu") %>%
as.matrix %>%
tax_table
SAMPLES_16S_pooled_phyloseq=
Metadata_ITS_LINDA_pooled %>%
filter(TreeSampleType %in% rownames(OtuMat16S_rare_pooled)) %>%
column_to_rownames("TreeSampleType") %>%
sample_data()
Phyloseq_pooled_ITS <- phyloseq(OTU_16S_pooled_phyloseq, TAX_16S_pooled_phyloseq, SAMPLES_16S_pooled_phyloseq)
Phyloseq_pooled_16S <- phyloseq(OTU_16S_pooled_phyloseq, TAX_16S_pooled_phyloseq, SAMPLES_16S_pooled_phyloseq)
#subset phyloseq object into root and soil samples
Phyloseq_pooled_16S_root=subset_samples(Phyloseq_pooled_16S, SampleType=="Root")
Phyloseq_pooled_16S_soil=subset_samples(Phyloseq_pooled_16S, SampleType=="Soil")
## 16S root ANCOMBC-2 test
```{r, warning=FALSE, message=FALSE}
ANCOM_16S_pooled_root = ancombc2(data = Phyloseq_pooled_16S_root,
fix_formula = "TreeSpecies",
p_adj_method = "fdr", pseudo_sens = TRUE,
prv_cut = 0.10, lib_cut = 1000, s0_perc = 0.05,
group = "TreeSpecies", struc_zero = FALSE, neg_lb = FALSE,
alpha = 0.05, n_cl = 2, verbose = TRUE,
global = TRUE, pairwise = FALSE,
dunnet = FALSE, trend = FALSE,
iter_control = list(tol = 1e-5, max_iter = 20,
verbose = FALSE),
em_control = list(tol = 1e-5, max_iter = 100),
lme_control = lme4::lmerControl(),
mdfdr_control = list(fwer_ctrl_method = "fdr", B = 100),
trend_control = NULL)
ANCOM_16S_pooled_root_df=
ANCOM_16S_pooled_root$res %>%
as.data.frame %>%
rename("otu"="taxon") %>%
left_join(TaxMat16S) %>%
mutate(TaxClass=ifelse(!is.na(Species),Species,ifelse(!is.na(Genus),Genus,ifelse(!is.na(Family),Family,ifelse(!is.na(Order),Order,ifelse(!is.na(Class),Class,ifelse(!is.na(Phylum),Phylum,Kingdom)))))))
ANCOM_16S_pooled_root_df_plot=
ANCOM_16S_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
View(ANCOM_16S_pooled_root_df_plot)
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass)
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass)
ANCOM_16S_pooled_soil = ancombc2(data = Phyloseq_pooled_16S_soil,
fix_formula = "TreeSpecies",
p_adj_method = "fdr", pseudo_sens = TRUE,
prv_cut = 0.10, lib_cut = 1000, s0_perc = 0.05,
group = "TreeSpecies", struc_zero = FALSE, neg_lb = FALSE,
alpha = 0.05, n_cl = 2, verbose = TRUE,
global = TRUE, pairwise = FALSE,
dunnet = FALSE, trend = FALSE,
iter_control = list(tol = 1e-5, max_iter = 20,
verbose = FALSE),
em_control = list(tol = 1e-5, max_iter = 100),
lme_control = lme4::lmerControl(),
mdfdr_control = list(fwer_ctrl_method = "fdr", B = 100),
trend_control = NULL)
ANCOM_16S_pooled_soil_df=
ANCOM_16S_pooled_soil$res %>%
as.data.frame %>%
rename("otu"="taxon") %>%
left_join(TaxMat16S) %>%
mutate(TaxClass=ifelse(!is.na(Species),Species,ifelse(!is.na(Genus),Genus,ifelse(!is.na(Family),Family,ifelse(!is.na(Order),Order,ifelse(!is.na(Class),Class,ifelse(!is.na(Phylum),Phylum,Kingdom)))))))
ANCOM_16S_pooled_soil_df_plot=
ANCOM_16S_pooled_soilt_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ANCOM_16S_pooled_soil_df_plot=
ANCOM_16S_pooled_soil_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass)
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass)
ANCOM_16S_pooled_root_df_plot
ANCOM_ITS_pooled_root_df_plot
pwd()
list.files()
list.files(../)
list.files("../")
write.csv(ANCOM_ITS_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_root_df_plot.csv")
write.csv(ANCOM_ITS_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_soil_df_plot.csv")
write.csv(ANCOM_16S_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_root_df_plot.csv")
write.csv(ANCOM_16S_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_soil_df_plot.csv")
write.csv(ANCOM_ITS_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_soil_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_16S_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_16S_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_soil_df_plot.csv", row.names = FALSE)
ANCOM_16S_soil_plot=
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass)
ANCOM_16S_root_plot=
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass)
ANCOM_ITS_soil_plot=
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_soil_df_plot$TaxClass)
ANCOM_ITS_root_plot=
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass)
save.image(ANCOM_ITS_root_plot, "../ANCOMBC-2/ANCOM_ITS_root_plot")
save.image(ANCOM_ITS_root_plot, file="../ANCOMBC-2/ANCOM_ITS_root_plot")
png(ANCOM_ITS_root_plot, file="../ANCOMBC-2/ANCOM_ITS_root_plot")
png(ANCOM_ITS_root_plot, "../ANCOMBC-2/ANCOM_ITS_root_plot")
ANCOM_ITS_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png")
ANCOM_ITS_root_plot
ANCOM_ITS_root_plot=
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass) +
ggtitle("Fungi different between roots")
ANCOM_ITS_root_plot
ANCOM_ITS_root_plot=
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass) +
ggtitle("Fungi different between roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_root_plot
ANCOM_ITS_root_plot=
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass) +
ggtitle("Fungi different between roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_soil_plot=
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_soil_df_plot$TaxClass) +
ggtitle("Fungi different between soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_soil_plot=
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_soil_df_plot$TaxClass) +
ggtitle("Fungi different in soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_root_plot=
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_ITS_pooled_root_df_plot$TaxClass) +
ggtitle("Fungi different in roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_16S_root_plot=
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass) +
ggtitle("Bacteria different in roots") +
theme(plot.title = element_text(hjust = 0.5))
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png")
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png")
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png")
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png")
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png")
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png")
ANCOM_16S_soil_plot=
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_root_df_plot$TaxClass) +
ggtitle("Bacteria different in soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png")
ANCOM_ITS_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png")
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png")
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png")
ANCOM_16S_root_plot
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png")
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png")
ANCOM_16S_soil_plot=
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
scale_x_discrete(labels = ANCOM_16S_pooled_soil_df_plot$TaxClass) +
ggtitle("Bacteria different in soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png")
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png")
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png")
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png")
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=200, height=500)
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=5, height=7)
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=8, height=7)
ANCOM_ITS_root_plot
ANCOM_ITS_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=8, height=7)
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=8, height=5)
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=6, height=4)
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ANCOM_16S_root_plot
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=7)
ANCOM_16S_root_plot
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=9)
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=8)
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=9)
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
ANCOM_ITS_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=6, height=4)
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
View(ANCOM_ITS_pooled_root_df)
nrow(ANCOM_ITS_pooled_root_df)
View(ANCOM_ITS_pooled_root_df)
