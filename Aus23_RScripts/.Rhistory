as.data.frame %>%
rename("otu"="taxon")
ANCOM_ITS_pooled_soil_df_plot=
ANCOM_ITS_pooled_soil_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ANCOM_ITS_soil_plot=
ggplot(ANCOM_ITS_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Fungi different in soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_soil_plot
ANCOM_ITS_root_plot
ANCOM_16S_pooled_root = ancombc2(data =subset_taxa(Phyloseq_pooled_16S_root, !is.na(Genus) & Genus != ""),
fix_formula = "TreeSpecies",
tax_level="Genus",
p_adj_method = "fdr", pseudo_sens = TRUE,
prv_cut = 0.10, lib_cut = 1000, s0_perc = 0.05,
group = "TreeSpecies", struc_zero = FALSE, neg_lb = FALSE,
alpha = 0.05, n_cl = 2, verbose = TRUE,
global = TRUE, pairwise = FALSE,
dunnet = FALSE, trend = FALSE,
iter_control = list(tol = 1e-5, max_iter = 20,
verbose = FALSE),
em_control = list(tol = 1e-5, max_iter = 100),
lme_control = lme4::lmerControl(),
mdfdr_control = list(fwer_ctrl_method = "fdr", B = 100),
trend_control = NULL)
ANCOM_16S_pooled_root_df=
ANCOM_16S_pooled_root$res %>%
as.data.frame %>%
rename("otu"="taxon")
ANCOM_16S_pooled_root_df_plot=
ANCOM_16S_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ANCOM_16S_root_plot=
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Fungi different in roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_16S_root_plot
ANCOM_16S_pooled_soil = ancombc2(data =subset_taxa(Phyloseq_pooled_16S_soil, !is.na(Genus) & Genus != ""),
fix_formula = "TreeSpecies",
tax_level="Genus",
p_adj_method = "fdr", pseudo_sens = TRUE,
prv_cut = 0.10, lib_cut = 1000, s0_perc = 0.05,
group = "TreeSpecies", struc_zero = FALSE, neg_lb = FALSE,
alpha = 0.05, n_cl = 2, verbose = TRUE,
global = TRUE, pairwise = FALSE,
dunnet = FALSE, trend = FALSE,
iter_control = list(tol = 1e-5, max_iter = 20,
verbose = FALSE),
em_control = list(tol = 1e-5, max_iter = 100),
lme_control = lme4::lmerControl(),
mdfdr_control = list(fwer_ctrl_method = "fdr", B = 100),
trend_control = NULL)
ANCOM_16S_pooled_soil_df=
ANCOM_16S_pooled_soil$res %>%
as.data.frame %>%
rename("otu"="taxon")
ANCOM_16S_pooled_soil_df_plot=
ANCOM_16S_pooled_soil_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ANCOM_16S_soil_plot=
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Fungi different in soils") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot=
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Fungi different in soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_16S_soil_plot
ANCOM_sig_OTUs_ITS=
rbind(ANCOM_ITS_pooled_root_df_plot, ANCOM_ITS_pooled_soil_df_plot) %$%
otu %>%
unique
ANCOM_sig_OTUs_16S=
rbind(ANCOM_16S_pooled_root_df_plot, ANCOM_16S_pooled_soil_df_plot) %$%
otu %>%
unique
ANCOM_sig_OTUs_ITS=
rbind(ANCOM_ITS_pooled_root_df_plot, ANCOM_ITS_pooled_soil_df_plot) %$%
otu %>%
unique
ANCOM_sig_OTUs_ITS=
rbind(ANCOM_ITS_root_df_plot, ANCOM_ITS_soil_df_plot) %$%
otu %>%
unique
ANCOM_sig_OTUs_ITS=
rbind(ANCOM_ITS_pooled_soil_df_plot, ANCOM_ITS_pooled_root_df_plot) %$%
otu %>%
unique
View(ANCOM_ITS_pooled_root_df_plot)
View(ANCOM_ITS_pooled_soil_df_plot)
ANCOM_ITS_pooled_root_df=
ANCOM_ITS_pooled_root$res %>%
as.data.frame %>%
rename("otu"="taxon")
View(ANCOM_ITS_pooled_root_df)
ANCOM_ITS_pooled_root_df_plot=
ANCOM_ITS_pooled_root_df %>%
filter(p_TreeSpeciesPine<0.05) %>%
mutate(HostID=case_when(lfc_TreeSpeciesPine<0 ~ "Eucalyptus",
lfc_TreeSpeciesPine>0 ~ "Pine",
.default=NA),
otu = factor(otu, levels = otu[order(lfc_TreeSpeciesPine)]))
ANCOM_ITS_root_plot=
ggplot(ANCOM_ITS_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Fungi different in roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_sig_OTUs_ITS=
rbind(ANCOM_ITS_pooled_soil_df_plot, ANCOM_ITS_pooled_root_df_plot) %$%
otu %>%
unique
ANCOM_sig_OTUs_16S=
rbind(ANCOM_16S_pooled_root_df_plot, ANCOM_16S_pooled_soil_df_plot) %$%
otu %>%
unique
ANCOM_ITS_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_root_plot.png", width=6, height=4)
ANCOM_ITS_soil_plot
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_16S_soil_plot
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
write.csv(ANCOM_sig_OTUs_ITS, "../ANCOMBC-2/ANCOM_sig_OTUs_ITS.csv", row.names = FALSE)
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
write.csv(ANCOM_sig_OTUs_ITS, "../ANCOMBC-2/ANCOM_sig_OTUs_ITS.csv", row.names = FALSE)
write.csv(ANCOM_sig_OTUs_16S, "../ANCOMBC-2/ANCOM_sig_OTUs_16S.csv", row.names = FALSE)
write.csv(ANCOM_sig_OTUs_16S, "../ANCOMBC-2/ANCOM_sig_OTUs_16S.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_soil_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_16S_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_sig_OTUs_16S, "../ANCOMBC-2/ANCOM_sig_OTUs_16S.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_ITS_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_ITS_pooled_soil_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_16S_pooled_root_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_root_df_plot.csv", row.names = FALSE)
write.csv(ANCOM_16S_pooled_soil_df_plot, "../ANCOMBC-2/ANCOM_16S_pooled_soil_df_plot.csv", row.names = FALSE)
ANCOM_16S_root_plot=
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Bacteria different in roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_16S_soil_plot=
ggplot(ANCOM_16S_pooled_soil_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Bacteria different in soil") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_root_plot
ANCOM_ITS_soil_plot
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
ANCOM_16S_root_plot=
ggplot(ANCOM_16S_pooled_root_df_plot, aes(x=otu, y=lfc_TreeSpeciesPine)) +
geom_bar(stat="identity", aes(fill=HostID)) +
geom_hline(yintercept=0, color="black") +
coord_flip() +
theme_test() +
ylab("Log2FoldChange") +
ggtitle("Bacteria different in roots") +
theme(plot.title = element_text(hjust = 0.5))
ANCOM_ITS_root_plot
ANCOM_ITS_soil_plot
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=6)
ANCOM_16S_root_plot
ggsave("../ANCOMBC-2/ANCOM_16S_root_plot.png", width=6, height=10)
ANCOM_16S_soil_plot
ggsave("../ANCOMBC-2/ANCOM_16S_soil_plot.png", width=6, height=10)
ANCOM_ITS_soil_plot
ANCOM_ITS_soil_plot
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=4)
ggsave("../ANCOMBC-2/ANCOM_ITS_soil_plot.png", width=6, height=4)
ANCOM_16S_root_plot
save.image()
OtuMatITS_pooled_rel %>% dim
OtuMatITS_pooled_rel %>% ncol
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>% colnames
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>% rownames
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(TaxMatITS)
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(TaxMatITS) %>%
filter(Genus=="Suillus")
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus)) %>%
filter(Genus=="Suillus")
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus)) %>%
filter(Genus=="Suillus") %>%
gather(sample, "Abundance", -Genus,-otu)
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus)) %>%
filter(Genus=="Suillus") %>%
gather(sample, "Abundance", -Genus,-otu) %>% View
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus, Species)) %>%
filter(Genus=="Suillus") %>%
select(-Genus) %>%
gather(sample, "Abundance", -Species,-otu) %>% View
Suillus_abund_long=
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus, Species)) %>%
filter(Genus=="Suillus") %>%
select(-Genus) %>%
gather(sample, "Abundance", -Species,-otu) %>%
left_join(Metadata_ITS)
View(Metadata_ITS)
Suillus_abund_long=
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus, Species)) %>%
filter(Genus=="Suillus") %>%
select(-Genus) %>%
gather(SampleID, "Abundance", -Species,-otu) %>%
left_join(Metadata_ITS)
View(Suillus_abund_long)
Suillus_abund_long=
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus, Species)) %>%
filter(Genus=="Suillus") %>%
select(-Genus) %>%
gather(SampleID, "Abundance", -Species,-otu) %>%
left_join(Metadata_ITS_pooled)
View(Metadata_ITS_pooled)
Suillus_abund_long=
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus, Species)) %>%
filter(Genus=="Suillus") %>%
select(-Genus) %>%
gather(TreeSampleType, "Abundance", -Species,-otu) %>%
left_join(Metadata_ITS_pooled)
ggplot(Suillus_abund_long, aes(x=Species, y=Abuncance,
color=SampleType)) +
geom_boxplot()
ggplot(Suillus_abund_long, aes(x=Species, y=Abundance,
color=SampleType)) +
geom_boxplot()
ggplot(Suillus_abund_long, aes(x=TreeSpecies, y=Abundance,
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species)
ggplot(Suillus_abund_long, aes(x=TreeSpecies, y=Abundance,
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg"),
aes(x=TreeSpecies, y=Abundance,
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=TreeSpecies, y=Abundance,
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=SampleType, y=Abundance,
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=SampleType, y=log(Abundance+0.00001),
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
#Rhizopogon
Rhizopogon_abund_long=
OtuMatITS_pooled_rel %>%
t %>%
as.data.frame %>%
mutate(otu=rownames(.)) %>%
left_join(select(TaxMatITS, otu, Genus, Species)) %>%
filter(Genus=="Rhizopogon") %>%
select(-Genus) %>%
gather(TreeSampleType, "Abundance", -Species,-otu) %>%
left_join(Metadata_ITS_pooled)
ggplot(filter(Rhizopogon_abund_long, SampleType!="Neg"),
aes(x=TreeSpecies, y=Abundance,
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=SampleType, y=log(Abundance+0.00001),
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=SampleType, y=log(Abundance+0.00001),
color=TreeSpecies)) +
geom_boxplot() +
geom_point() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=SampleType, y=log(Abundance+0.00001),
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Rhizopogon_abund_long, SampleType!="Neg"),
aes(x=TreeSpecies, y=log(Abundance+0.00001),
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Rhizopogon_abund_long, SampleType!="Neg"),
aes(x=SampleType, y=log(Abundance+0.00001),
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
OtuMatITS_rare_pooled %>% ncol()
OtuMatITS_rare_pooled$colnames !%in% OtuMatITS_rare_rel$colnames
!(OtuMatITS_rare_pooled$colnames %in% OtuMatITS_rare_rel$colnames)
(OtuMatITS_rare_pooled$colnames %in% OtuMatITS_rare_rel$colnames) %>% length
(OtuMatITS_rare_pooled$colnames %in% OtuMatITS_rare_rel$colnames)
!(colnames(OtuMatITS_rare_rel$colnames) %in% colnames(OtuMatITS_rare_rel))
!(olnames(OtuMatITS_rare_rel$colnames) %in% colnames(OtuMatITS_rare_rel))
(colnames(OtuMatITS_rare_rel$colnames) %in% colnames(OtuMatITS_rare_rel))
(colnames(OtuMatITS_rare_rel) %in% colnames(OtuMatITS_rare_rel))
!(colnames(OtuMatITS_rare_rel) %in% colnames(OtuMatITS_rare_rel))
!(colnames(OtuMatITS_rare_rel) %in% colnames(OtuMatITS_rare_rel)) %>% sum
(colnames(OtuMatITS_rare_rel) %in% colnames(OtuMatITS_rare_rel)) %>% sum
!(colnames(OtuMatITS_rare_pooled) %in% colnames(OtuMatITS_rare_rel))
!(colnames(OtuMatITS_rare_pooled) %in% colnames(OtuMatITS_rare_rel)) %>% sum
!(colnames(OtuMatITS_rare_pooled) %in% colnames(OtuMatITS_rare_rel))
sum(!(colnames(OtuMatITS_rare_pooled) %in% colnames(OtuMatITS_rare_rel)))
sum((colnames(OtuMatITS_rare_pooled) %in% colnames(OtuMatITS_rare_rel)))
sum(!(colnames(OtuMatITS_rare_pooled) %in% colnames(OtuMatITS_rare_pooled_rel)))
"7f24a5a5fcf5a461429bf42b935a3a87" %in% colnames(OtuMatITS_rare_pooled_rel)
"7f24a5a5fcf5a461429bf42b935a3a87" %in% colname(OtuMatITS_rel)
"7f24a5a5fcf5a461429bf42b935a3a87" %in% colnames(OtuMatITS_rel)
dim(OtuMatITS_rel)
ITS2_Dada2_reps
ITS2_Dada2_repseqs97_taxonomy_edited_Funt_Fung
TaxITS_funguild %>% filter(Genus=="Thelephora")
colnames(TaxITS_funguild)
TaxMatITS %>% filter(Genus=="Thelephora")
ggplot(filter(Suillus_abund_long, SampleType!="Neg",Species=="Suillus_quiescens"),
aes(x=SampleType, y=log(Abundance+0.00001),
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg"),
aes(x=TreeSpecies, y=Abundance,
color=SampleType)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
ggplot(filter(Suillus_abund_long, SampleType!="Neg"),
aes(x=SampleType, y=Abundance,
color=TreeSpecies)) +
geom_boxplot() +
facet_wrap(.~Species, scales="free_y")
knitr::opts_chunk$set(echo = TRUE)
library(MicrobiomeStat)
library(dplyr)
library(magrittr)
library(tibble)
library(ANCOMBC)
View(ANCOM_ITS_pooled_root_df_plot)
library(magrittr)
library(tidyverse)
library(readxl)
library(phyloseq)
View(ANCOM_ITS_pooled_soil_df_plot)
View(ANCOM_ITS_pooled_soil_df)
otu.genus.its <- read.csv("Aus-Invasions-2023-Course/Aus23_ITS_Metabarcoding/OTUTables/OtuMatITS_rare_byGenus_pooled.csv", row.names=1)
otu.genus.its <- read.csv("Aus-Invasions-2023-Course/Aus23_ITS_Metabarcoding/OTUTables/OtuMatITS_rare_byGenus_pooled.csv", row.names=1)
otu.genus.its <- read.csv("../Aus23_ITS_Metabarcoding/OTUTables/OtuMatITS_rare_byGenus_pooled.csv", row.names=1)
ncol(otu.genus.its)
row.names(otu.genus.its)
Metadata_ITS_pooled$colnames
Metadata_ITS_pooled %>%colnames
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
ggplot(aes(x=SampleType, y=Mycena, color=TreeSpecies)) +
geom_boxplot()
Metadata_ITS_pooled %>%colnames
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=SampleType, y=Mycena, color=TreeSpecies)) +
geom_boxplot()
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=SampleType, y=Russula, color=TreeSpecies)) +
geom_boxplot()
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=Tree, y=Russula, color=TreeSpecies)) +
geom_boxplot()
Metadata_ITS_pooled %>%colnames
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=TreeID, y=Russula, color=TreeSpecies)) +
geom_boxplot()
Metadata_ITS_pooled %>%colnames
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=paste(TreeID,SampleType), y=Russula, color=TreeSpecies)) +
geom_boxplot()
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=SampleType, y=Russula, color=TreeSpecies)) +
geom_boxplot()
otu.genus.its %>%
mutate(TreeSampleType=rownames(.)) %>%
left_join(Metadata_ITS_pooled) %>%
ggplot(aes(x=SampleType, y=Russula, color=TreeSpecies)) +
geom_boxplot()
View(TaxITS_funguild)
